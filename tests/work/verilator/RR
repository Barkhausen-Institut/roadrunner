sim:
  tool: Verilator
  sv: src/sim.sv
  toplevel: SimTest

simTrace:
  tool: sequence
  veri:
    tool: Verilator
    sv: src/sim.sv
    toplevel: SimTest
    trace: vcd
    expose: waves.vcd
  check:
    tool: Shell
    discover: waves.vcd
    script: |
      if [ -f waves.vcd ]; then
        echo "waves file found"
        exit 0
      else
        echo "waves file NOT found"
        exit 1
      fi

simFail:
  tool: Verilator
  sv: src/sim_fail.sv
  toplevel: SimTest

#does not work - verilator does not support defines for specific files
sepCompileUnit:
  tool: Verilator
  sv: src/top.sv
  toplevel: SimTest
  inc:
    -
      sv: src/mod1.sv
      define: MOD1=1
    -
      sv: src/mod2.sv
      define: MOD2=2

sim_inc:
  tool: Verilator
  sv: src/sim_inc.sv
  path:
    - src/values.svh #file
    - header #directory
  toplevel: SimTest

dpi:
  tool: Verilator
  sv: src/simDpi.sv
  toplevel: SimTest
  inc:
    - =;greeter
    - =;retval
    - =;greeter # check if greeter.cc is compiled only once - can only be done by hand
greeter:
  dpiModule:
    c: src/greeter.cc
retval:
  dpiModule:
    c: src/retval.cc

dpiHeader:
  tool: Verilator
  sv: src/simDpi.sv
  toplevel: SimTest
  dpiModule:
    c: src/dpi_header.cc
    path: header

lint:
  tool: Verilator.lint
  sv: src/sim.sv
  toplevel: SimTest

waiver:
  tool: Verilator.lint
  sv: src/WarningTest.sv
  toplevel: WarningTest
  vWaiver:
    rule: UNOPTFLAT
    file: src/WarningTest.sv
    lines: 11-15

all:
  tool: Flow.pool
  sim: =;sim
  sim_inc: =;sim_inc
  dpi: =;dpi
  dpiHeader: =;dpiHeader
  lint: =;lint
  waiver: =;waiver
  simTrace: =;simTrace